---
title: Utils
layout: api
breadcrumb: ['api/Thruk/', 'Thruk', 'api/Thruk/NodeControl/', 'NodeControl']
---





<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#update_cron_file">update_cron_file</a></li>
      <li><a href="#get_peers">get_peers</a></li>
      <li><a href="#get_server">get_server</a></li>
      <li><a href="#ansible_get_facts">ansible_get_facts</a></li>
      <li><a href="#update_runtime_data">update_runtime_data</a></li>
      <li><a href="#omd_install">omd_install</a></li>
      <li><a href="#omd_update">omd_update</a></li>
      <li><a href="#omd_install_update_cleanup">omd_install_update_cleanup</a></li>
      <li><a href="#os_update">os_update</a></li>
      <li><a href="#os_sec_update">os_sec_update</a></li>
      <li><a href="#omd_cleanup">omd_cleanup</a></li>
      <li><a href="#omd_service">omd_service</a></li>
      <li><a href="#config">config</a></li>
      <li><a href="#save_config">save_config</a></li>
      <li><a href="#get_available_omd_versions">get_available_omd_versions</a></li>
      <li><a href="#get_addon_modules">get_addon_modules</a></li>
      <li><a href="#clean_old_json_files">clean_old_json_files</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Thruk::NodeControl::Utils - Helper for the node control addon</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Helper for the node control addon</p>

<h1 id="METHODS">METHODS</h1>

<h2 id="update_cron_file">update_cron_file</h2>

<pre><code>update_cron_file($c)</code></pre>

<p>update controlled nodes cronjobs</p>

<h2 id="get_peers">get_peers</h2>

<pre><code>get_peers($c)</code></pre>

<p>return list of available peers</p>

<h2 id="get_server">get_server</h2>

<pre><code>get_server($c, $peer, [$config])</code></pre>

<p>return server details</p>

<h2 id="ansible_get_facts">ansible_get_facts</h2>

<pre><code>ansible_get_facts($c, $peer, [$refresh])</code></pre>

<p>return ansible gather facts</p>

<h2 id="update_runtime_data">update_runtime_data</h2>

<pre><code>update_runtime_data($c, $peer, [$skip_cpu])</code></pre>

<p>update runtime data and return facts</p>

<h2 id="omd_install">omd_install</h2>

<pre><code>omd_install($c, $peer, $version, $force)</code></pre>

<p>installs given version on peer</p>

<h2 id="omd_update">omd_update</h2>

<pre><code>omd_update($c, $peer, $version)</code></pre>

<p>update site to given version on peer in background, returns job id</p>

<h2 id="omd_install_update_cleanup">omd_install_update_cleanup</h2>

<pre><code>omd_install_update_cleanup($c, $peer, $version)</code></pre>

<p>install and update site to given version on peer, then run cleanup</p>

<h2 id="os_update">os_update</h2>

<pre><code>os_update($c, $peer)</code></pre>

<p>update os packages</p>

<h2 id="os_sec_update">os_sec_update</h2>

<pre><code>os_sec_update($c, $peer)</code></pre>

<p>update os security packages</p>

<h2 id="omd_cleanup">omd_cleanup</h2>

<pre><code>omd_cleanup($c, $peer)</code></pre>

<p>runs omd cleanup on peer</p>

<h2 id="omd_service">omd_service</h2>

<pre><code>omd_service($c, $peer, $service, $cmd)</code></pre>

<p>start/stop omd services</p>

<h2 id="config">config</h2>

<pre><code>config($c)</code></pre>

<p>return node control config</p>

<h2 id="save_config">save_config</h2>

<pre><code>save_config($c)</code></pre>

<p>save config to disk</p>

<h2 id="get_available_omd_versions">get_available_omd_versions</h2>

<pre><code>get_available_omd_versions($c)</code></pre>

<p>returns omd versions which can be used to update</p>

<h2 id="get_addon_modules">get_addon_modules</h2>

<pre><code>get_addon_modules()</code></pre>

<p>returns addon modules</p>

<h2 id="clean_old_json_files">clean_old_json_files</h2>

<pre><code>clean_old_json_files()</code></pre>

<p>remove old json files from var path</p>


