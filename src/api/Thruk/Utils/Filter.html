---
title: Filter
layout: api
breadcrumb: ['api/Thruk/', 'Thruk', 'api/Thruk/Utils/', 'Utils']
---





<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#METHODS">METHODS</a>
    <ul>
      <li><a href="#throw">throw</a></li>
      <li><a href="#contains">contains</a></li>
      <li><a href="#duration">duration</a></li>
      <li><a href="#nl2br">nl2br</a></li>
      <li><a href="#sprintf">sprintf</a></li>
      <li><a href="#date_format">date_format</a></li>
      <li><a href="#last_check">last_check</a></li>
      <li><a href="#uri">uri</a></li>
      <li><a href="#full_uri">full_uri</a></li>
      <li><a href="#short_uri">short_uri</a></li>
      <li><a href="#uri_with">uri_with</a></li>
      <li><a href="#as_url_arg">as_url_arg</a></li>
      <li><a href="#html_escape">html_escape</a></li>
      <li><a href="#escape_html">escape_html</a></li>
      <li><a href="#escape_quotes">escape_quotes</a></li>
      <li><a href="#escape_ampersand">escape_ampersand</a></li>
      <li><a href="#remove_html_comments">remove_html_comments</a></li>
      <li><a href="#validate_json">validate_json</a></li>
      <li><a href="#get_action_menu">get_action_menu</a></li>
      <li><a href="#json_encode">json_encode</a></li>
      <li><a href="#encode_json_obj">encode_json_obj</a></li>
      <li><a href="#escape_js">escape_js</a></li>
      <li><a href="#escape_bslash">escape_bslash</a></li>
      <li><a href="#escape_xml">escape_xml</a></li>
      <li><a href="#escape_regex">escape_regex</a></li>
      <li><a href="#name2id">name2id</a></li>
      <li><a href="#uniqnumber">uniqnumber</a></li>
      <li><a href="#get_message">get_message</a></li>
      <li><a href="#strip_command_args">strip_command_args</a></li>
      <li><a href="#calculate_first_notification_delay_remaining">calculate_first_notification_delay_remaining</a></li>
      <li><a href="#action_icon">action_icon</a></li>
      <li><a href="#logline_icon">logline_icon</a></li>
      <li><a href="#has_business_process">has_business_process</a></li>
      <li><a href="#button">button</a></li>
      <li><a href="#fullversion">fullversion</a></li>
      <li><a href="#split_perfdata">split_perfdata</a></li>
      <li><a href="#get_user_token">get_user_token</a></li>
      <li><a href="#get_cmd_submit_hash">get_cmd_submit_hash</a></li>
      <li><a href="#replace_macros">replace_macros</a></li>
      <li><a href="#set_time_locale">set_time_locale</a></li>
      <li><a href="#lc">lc</a></li>
    </ul>
  </li>
</ul>

<h1 id="NAME">NAME</h1>

<p>Thruk::Utils::Filter - Filter Utilities Collection for Thruk</p>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>Filter Utilities Collection for Thruk</p>

<h1 id="METHODS">METHODS</h1>

<h2 id="throw">throw</h2>

<pre><code>  throw($string)</code></pre>

<p>can be used to die in templates</p>

<h2 id="contains">contains</h2>

<pre><code>  contains($haystack, $needle)</code></pre>

<p>returns true if needle is found in haystack or needle equals haystack</p>

<h2 id="duration">duration</h2>

<pre><code>  my $string = duration($seconds, [$options]);</code></pre>

<p>formats a duration into the format: 0d 0h 29m 43s</p>

<pre><code>  $options:
        0    =&gt;    0h 0m 15s
        1    =&gt; 0d 0h 0m 15s  (default)
        2    =&gt;   0min 14sec
        3    =&gt;       0m 04s
        4    =&gt;          15m (trimmed)
        5    =&gt;        15min (trimmed)</code></pre>

<h2 id="nl2br">nl2br</h2>

<pre><code>  my $string = nl2br($string);</code></pre>

<p>replace newlines with linebreaks</p>

<h2 id="sprintf">sprintf</h2>

<pre><code>  my $string = sprintf($format, $list)</code></pre>

<p>wrapper around the internal sprintf</p>

<h2 id="date_format">date_format</h2>

<pre><code>  my $string = date_format($c, $seconds);</code></pre>

<p>formats a time definition into date format</p>

<h2 id="last_check">last_check</h2>

<pre><code>  my $string = last_check($c, $last_check);</code></pre>

<p>returns formated last check date</p>

<h2 id="uri">uri</h2>

<pre><code>  uri($c)</code></pre>

<p>returns html escaped current absolute uri without any filter</p>

<p>ex.: /thruk/cgi-bin/status.cgi?params...</p>

<h2 id="full_uri">full_uri</h2>

<pre><code>  full_uri($c, $return_full_url)</code></pre>

<p>returns html escaped uri to current page with default filters.</p>

<p>ex.: /thruk/cgi-bin/status.cgi?params...</p>

<pre><code>    with return_full_url:
    http://hostname/thruk/cgi-bin/status.cgi?params</code></pre>

<h2 id="short_uri">short_uri</h2>

<pre><code>  short_uri($c, $filter)</code></pre>

<p>returns a html escaped correct uri but only the url part</p>

<p>ex.: status.cgi?params...</p>

<h2 id="uri_with">uri_with</h2>

<pre><code>  uri_with($c, $data, $keep_absolute)</code></pre>

<p>returns a relative uri to current page</p>

<p>ex.: status.cgi?params...</p>

<pre><code>    with keep_absolute:
    http://hostname/thruk/cgi-bin/status.cgi?params</code></pre>

<h2 id="as_url_arg">as_url_arg</h2>

<pre><code>  as_url_arg($str)</code></pre>

<p>returns encoded string for use in url args</p>

<h2 id="html_escape">html_escape</h2>

<pre><code>  html_escape($text)</code></pre>

<p>wrapper for escape_html for compatibility reasons</p>

<h2 id="escape_html">escape_html</h2>

<pre><code>  escape_html($text)</code></pre>

<p>returns an escaped string</p>

<h2 id="escape_quotes">escape_quotes</h2>

<pre><code>  escape_quotes($text)</code></pre>

<p>returns a string with only the single- or double-quotes escaped</p>

<h2 id="escape_ampersand">escape_ampersand</h2>

<pre><code>  escape_ampersand($text)</code></pre>

<p>returns a string with &amp; escaped to &amp;amp;</p>

<h2 id="remove_html_comments">remove_html_comments</h2>

<pre><code>  remove_html_comments($text)</code></pre>

<p>returns string with html comments removed</p>

<h2 id="validate_json">validate_json</h2>

<pre><code>  validate_json(...)</code></pre>

<p>returns error if json is invalid</p>

<h2 id="get_action_menu">get_action_menu</h2>

<pre><code>  get_action_menu(c, [name|menu])</code></pre>

<p>returns menu and error</p>

<h2 id="json_encode">json_encode</h2>

<pre><code>  json_encode(...)</code></pre>

<p>returns json encoded string</p>

<h2 id="encode_json_obj">encode_json_obj</h2>

<pre><code>  encode_json_obj(array, [decode])</code></pre>

<p>returns json encoded object</p>

<h2 id="escape_js">escape_js</h2>

<pre><code>  escape_js($text)</code></pre>

<p>used to escape html tags so it can be used as javascript string</p>

<h2 id="escape_bslash">escape_bslash</h2>

<pre><code>  escape_bslash($text)</code></pre>

<p>used to escape backslashes</p>

<h2 id="escape_xml">escape_xml</h2>

<pre><code>  escape_xml($text)</code></pre>

<p>returns an escaped string for xml output</p>

<h2 id="escape_regex">escape_regex</h2>

<pre><code>  escape_regex($text)</code></pre>

<p>returns an escaped string for regular expression</p>

<h2 id="name2id">name2id</h2>

<pre><code>  my $striped_string = name2id($name)</code></pre>

<p>returns a string which can be used as id in html elements</p>

<p>An id must begin with a letter ([A-Za-z]) and may be followed by any number of letters, digits ([0-9]), hyphens (&quot;-&quot;), underscores (&quot;_&quot;), colons (&quot;:&quot;), and periods (&quot;.&quot;).</p>

<h2 id="uniqnumber">uniqnumber</h2>

<pre><code>  uniqnumber()</code></pre>

<p>return uniq number which can be used in html ids</p>

<h2 id="get_message">get_message</h2>

<pre><code>  get_message($c)</code></pre>

<p>get a message from an cookie, display and delete it</p>

<h2 id="strip_command_args">strip_command_args</h2>

<pre><code>  my $striped_string = strip_command_args($command_name)</code></pre>

<p>returns a string without the arguments for a command</p>

<p>check_nrpe!$HOSTNAME$!check_disk -&gt; check_nrpe</p>

<h2 id="calculate_first_notification_delay_remaining">calculate_first_notification_delay_remaining</h2>

<pre><code>  my $remaining = calculate_first_notification_delay_remaining($obj)</code></pre>

<p>returns remaining minutes for first_notification_delay</p>

<h2 id="action_icon">action_icon</h2>

<pre><code>  my $icon = action_icon($obj, $fallback)</code></pre>

<p>returns action icon path</p>

<h2 id="logline_icon">logline_icon</h2>

<pre><code>  my $icon = logline_icon($logentry)</code></pre>

<p>returns icon path</p>

<h2 id="has_business_process">has_business_process</h2>

<pre><code>  has_business_process($host)</code></pre>

<p>returns true if host is part of an business process</p>

<h2 id="button">button</h2>

<pre><code>  my $html = button($link, $value, $class, [$onclick], [$formstyle], [$keeplink], [$skipform])</code></pre>

<p>returns button html source</p>

<h2 id="fullversion">fullversion</h2>

<pre><code>  my $str = fullversion($c)</code></pre>

<p>returns full version string</p>

<h2 id="split_perfdata">split_perfdata</h2>

<pre><code>  split_perfdata($string)</code></pre>

<p>return splitted performance data which can be used for tabular display</p>

<h2 id="get_user_token">get_user_token</h2>

<pre><code>  get_user_token($c)</code></pre>

<p>returns user token which can be used to validate requests</p>

<h2 id="get_cmd_submit_hash">get_cmd_submit_hash</h2>

<pre><code>  get_cmd_submit_hash($data)</code></pre>

<p>create hash used in service/host details page</p>

<h2 id="replace_macros">replace_macros</h2>

<pre><code>  replace_macros($text, $macros)</code></pre>

<p>return text with replaced macros</p>

<h2 id="set_time_locale">set_time_locale</h2>

<pre><code>  set LC_TIME locale</code></pre>

<p>remember to reset to default after template processing.</p>

<h2 id="lc">lc</h2>

<pre><code>  lower case text</code></pre>

<p>returns lower case string</p>


